<html>
<head>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<link href="https://code.getmdl.io/1.2.1/material.deep_orange-blue.min.css" rel="stylesheet">
<script defer src="https://code.getmdl.io/1.2.1/material.min.js"></script><meta content="width=device-width, initial-scale=1.0" name="viewport">
<style>
.demo-ribbon {
  width: 100%;
  height: 40vh;
  //background-image: url("hero.png");
  background-color: #f5f5f5;
  flex-shrink: 0;
}

.demo-main {
  margin-top: -35vh;
  flex-shrink: 0;
}

.demo-header .mdl-layout__header-row {
  padding-left: 40px;
}

.demo-container {
  max-width: 1600px;
  width: calc(100% - 16px);
  margin: 0 auto;
}

.demo-content {
  border-radius: 2px;
  padding: 80px 56px;
  margin-bottom: 80px;
}

.demo-layout.is-small-screen .demo-content {
  padding: 40px 28px;
}

.demo-content h3 {
  margin-top: 48px;
}

.demo-footer {
  padding-left: 40px;
}

.demo-footer .mdl-mini-footer--link-list a {
  font-size: 13px;
}
#view-source {
    float: right;
}
</style>
<script async="1" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript"></script><link href="../styles.css" rel="stylesheet">
<link href="../colorful.css" rel="stylesheet">
<script>
                    function show(toExpand)
                    {
                    if(
                       document.getElementById(toExpand).style.display == 'none'
                       ||
                       document.getElementById(toExpand).style.display == ''
                       )
                        document.getElementById(toExpand).style.display = 'block';
                    else
                        document.getElementById(toExpand).style.display = 'none';
                    }
                    </script><style>
                    div#expand_0{
                        display:none;
                    }</style>
</head>
<body><div class="demo-layout mdl-layout mdl-layout--fixed-header mdl-js-layout mdl-color--grey-100">
<header class="demo-header mdl-layout__header mdl-layout__header--scroll mdl-color--grey-100 mdl-color-text--grey-800"><div class="mdl-layout__header-row">
<span class="mdl-layout-title"><a href="../index.html" style="text-decoration:none; color:#444;" class="mdl-typography--headline">Tom Bertalan</a></span><div class="mdl-layout-spacer"></div>
</div></header><div class="demo-ribbon"></div>
<main class="demo-main mdl-layout__content"><div class="demo-container mdl-grid">
<div class="mdl-cell mdl-cell--2-col mdl-cell--hide-tablet mdl-cell--hide-phone"></div>
<div class="demo-content mdl-color--white mdl-shadow--4dp content mdl-color-text--grey-800 mdl-cell mdl-cell--8-col">
<div class="demo-crumbs mdl-color-text--grey-500">
<a href="../index.html">Home</a> &gt; <span>Gunnar</span><a href="http://github.com/tsbertalan/gunnar" id="view-source" class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-color--accent mdl-color-text--accent-contrast">View project files.</a>
</div>
<span></span><h1>Gunnar</h1>

<p>Gunnar is a differential-drive rover with LIDAR as its primary sense.
It uses Robot Operating System (ROS) to provide messaging between components,
and important algorithms such as particle filter
simultaneous localization and (grid) mapping (SLAM).</p>

<p>Real-time motor speed control and Hall-effect quadrature integration
is performed by an Arduino Uno. This accepts speed targets
and reports encoder counts to a Raspberry Pi 3B over USB.</p>

<p>The Pi runs ROS Indigo, with nodes for communication with the Arduino
and for reading a serial bytestream encoding laser scans measured by
a LIDAR unit extracted from a Neato XV-11 robotic vacuum cleaner.</p>

<p>The Pi itself connects over OpenVPN to a roscore running on an Ubuntu
workstation powered by an Intel i7-4770K CPU. This workstation runs
ROS nodes for SLAM (via <a href="http://wiki.ros.org/slam_gmapping">gmapping</a>)
and global/local path planning (via <a href="http://wiki.ros.org/move_base">move_base</a>).</p>

<p>Future goals for this project include:</p>

<ol>
<li>Use one of the pre-trained object identification networks such as Alex-Net
   to label salient things (e.g. furniture).
   This will allow the rover to perform useful tasks,
   like reminding me where I left my couch.</li>
<li>Experiment with a different motion model in the particle filter--train
   a small neural network representation for the robot dynamics to update particles,
   reviving old neural methods adaptive for process control.
   <sup>
   <a title="Rico-Martinez, Krischer, and Kevrekidis. (1992). Discrete- vs continuous-time nonlinear signal processing of Cu Electrodissolution Data." href="http://www.tandfonline.com/doi/abs/10.1080/00986449208936084">1</a>,
   <a title="Farber, Lapedes, Rico-Martinez, &amp; Kevrekidis. (1993). Identification of Continuous-Time Dynamical Systems: Neural Network Based Algorithms and Parallel Implementation. Proceedings of the Sixth SIAM Conference on Parallel Processing for Scientific Computing." href="http://arxiv.org/abs/comp-gas/9305001">2</a>
   </sup>
</li>
<li>Segment the grid map into rooms, likely by using one of several
   existing map segmentation algorithms (e.g. decomposing the map into a Voronoi graph),
   then allow destinations to be chosen from a list of rooms rather than
   requiring goal pose selection on a map. Present the menu of rooms in a small
   webapp, allowing me to send tiny cargo items around my apartment
   without firing up Rviz.</li>
<li>Integrate an accelerometer+gyroscope+magnetometer IMU, both for improved odometry,
   and detecting abnormal tilt (like when we start to back up a wall).</li>
<li>For safety, monitor motor current for spikes. In such a situation,
   we should interrupt the normal planning behaivior to avoid breaking gear teeth.</li>
<li>Build a charging dock, and choreograph an automated switchover to external power.
   My power supplies do have enough inertia to handle an abrupt switch in power source
   without killing the Raspberry Pi, but integrating a LiPo balance charger
   will be nontrivial. Currently, I plan to use transistors soldered in parallel with
   buttons on a commercial charger, as the balance chargers available on e.g. Sparkfun
   don't handle four-cell batteries.</li>
</ol>

<p>Here's a video of Gunnar autonomously navigating to user-selected waypoints,
mapping along the way.
<iframe width="100%" height="400" src="https://www.youtube.com/embed/QvHmg2tG9b0" frameborder="0" allowfullscreen></iframe></p>
</div>
<div class="mdl-cell mdl-cell--2-col mdl-cell--hide-tablet mdl-cell--hide-phone"></div>
<div class="mdl-cell mdl-cell--2-col mdl-cell--hide-tablet mdl-cell--hide-phone"></div>
<div class="demo-content mdl-color--white mdl-shadow--4dp content mdl-color-text--grey-800 mdl-cell mdl-cell--8-col">
<div class="entry-titles">
<a href="javascript:;" id="view-source" onclick="show('expand_0')" class="mdl-button mdl-js-button mdl-js-ripple-effect">Show/Hide</a><header class="tomsb-entry-header"><h2>LIDAR SLAM Outside</h2>
<p>31 January 2017</p></header>
</div>
<div id="expand_0">
<span></span><p>I learned two things this evening:</p>

<ol>
<li>The Neato XV-11 LIDAR is only good for about 12 feet or so,
   and, for reliable SLAM, well-featured walls should be kept within about half that.</li>
<li>Elevator doors can be cruel and uncaring monsters to the 9-inch-tall.</li>
</ol>

<p>At the broadcasted recommendation of A. Margolis on the HBRC mailing list,
I purchased a GL-MT300A-Ext "smart mini router".
This appears to be a tiny ARM PC running OpenWRT,
and presenting a web-based interface for configuration.</p>

<p>It has two antennae, an RJ45 uplink jack,
and an RJ45 client jack, and is USB-powered.
Ignoring the uplink jack, I connected the power and client jacks
to Gunnar's Raspberry Pi3,
and instructed the router to broadcast the SSID Gunnar on one antenna
and connect to the ambient wifi with the other.
It performs some NAT magic to provide internet from the ambient wifi to its own network,
but, more importantly, Gunnar now carries his own network with him,
to which I can connect my laptop.</p>

<p>So, I reconfigured to run roscore, SLAM, and move_base on my laptop
rather than my desktop, and tried to drive all the way to the laundry room
in an adjacent building. This required descending an elevator
(which attacked, breaking the hot-glue hold of one of Gunnar's webcams),
exiting through two doors, and traveling maybe two hundred feet across blacktop,
over bare dirt surrounding trees planted in blacktop cutouts,
and always with about six feet of sparsely planted landscaping margin between us and the building outer wall.</p>

<p>This landscaping margin was really a problem for SLAM--it kept us far enough away
from the wall that it usually didn't show up on the LIDAR,
didn't have enough leaves to show up well itself (since it's winter),
and was too obstructed to attempt driving inside.</p>

<p>So, for a long distance, localiztion was mostly odometry-only.</p>

<p>I restarted SLAM several times thorugh the journey--mostly just because
I approached a closed door, which got baked into the map,
and so holding the door open, clearing the map, and reassigning the navigation target
was the easiest way to proceed forward.
Although, now that I think back, I also could have just held the door
and teleoped through the falsely occupied map cells.</p>

<p>All in all, though, I'd say this was a succes. 
The laptop doesn't run gmapping and move_base simultaneously as smoothly as the desktop,
but it never lost connection while I was in 40-foot line-of-sight,
which means that I can consider doing a demonstration
for the kids at the local FIRST robotics club.</p>

<p>But it's indoor environments only for now,
at least until I wrangle some long-range SLAM method,
like maybe visual landmarks.</p>

<p>Below, I compiled restarted maps from several points in the evening
into an approximate combined whole, by eye.
Green-highlighted segments are indoors.
At bottom right, I superimposed the fourth and first (ground) floors,
with the fourth at lowered opacity.
<a href="courtyard.png">
<img src="courtyard.png" title="Click to enlarge." width="100%">
</a></p>
</div>
</div>
<div class="mdl-cell mdl-cell--2-col mdl-cell--hide-tablet mdl-cell--hide-phone"></div>
</div></main>
</div></body>
</html>
